---
import { Image } from "astro:assets";
import type { CollectionEntry } from "astro:content";
import { extractDescription } from "../../core/utils/extractDescription";

interface Props {
    post: CollectionEntry<"blog">;
    priority?: boolean;
}

const { post, priority = false } = Astro.props;
const { title, image,tags } = post.data;

const description = post.data.description || extractDescription(post.body);
---

<article
    class="bg-white rounded-[20px] shadow-md overflow-hidden hover:shadow-xl transition-shadow duration-300 border-2 border-[#0F4C5C] flex flex-col"
>
    {
        image && (
            <div class="relative">
                <Image
                    src={image}
                    alt={title}
                    class="w-full h-48 md:h-[280px] object-cover shrink-0"
                    loading={priority ? "eager" : "lazy"}
                    widths={[400, 640, 768]}
                    sizes="(max-width: 768px) 100vw, (max-width: 1024px) 50vw, 33vw"
                    transition:name={`${post.slug}-image`}
                />
                <span class="absolute top-4 left-4 bg-[#0F4C5C] text-white px-4 py-2 rounded-full text-sm font-semibold">
                    {tags}
                </span>
            </div>
        )
    }

    <div class="p-4 md:p-5 flex flex-col flex-1">
        <h2
            class="text-xl font-bold text-gray-900 mb-2 group-hover:text-teal-700 transition-colors line-clamp-2"
            transition:name={`blog-title-${post.slug}`}
        >
            <a href={`/blog/${post.slug}`}>
                {title}
            </a>
        </h2>

        <p
            class="text-gray-600 text-sm mb-3 line-clamp-3 md:line-clamp-5 leading-relaxed"
        >
            {description}
        </p>

        <!-- {
            tags && tags.length > 0 && (
                <div class="flex flex-wrap gap-2 mb-4">
                    {tags.map((tag) => (
                        <span class="text-xs bg-teal-100 text-teal-800 px-2 py-1 rounded-full">
                            {tag}
                        </span>
                    ))}
                </div>
            )
        } -->

        <div class="mt-auto flex justify-end">
            <a
                href={`/blog/${post.slug}`}
                class="inline-flex items-center text-teal-700 hover:text-teal-900 font-medium transition-colors text-sm"
            >
                Leer m√°s
                <svg
                    class="w-4 h-4 ml-2"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                >
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M9 5l7 7-7 7"></path>
                </svg>
            </a>
        </div>
    </div>
</article>
